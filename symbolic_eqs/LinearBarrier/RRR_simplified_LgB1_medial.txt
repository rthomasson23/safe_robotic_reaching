[(L1*(L2^2*l3^2*m3^2*nx*cos(q1 - 2*q3) - 4*Izz2*Izz3*ny*sin(q1) - 4*Izz3*L2^2*m3*nx*cos(q1) - 4*Izz3*L2^2*m3*ny*sin(q1) - 4*Izz2*Izz3*nx*cos(q1) + L2^2*l3^2*m3^2*nx*cos(q1 + 2*q3) - 4*Izz3*l2^2*m2*nx*cos(q1) - 4*Izz2*l3^2*m3*nx*cos(q1) + L2^2*l3^2*m3^2*ny*sin(q1 - 2*q3) + L2^2*l3^2*m3^2*ny*sin(q1 + 2*q3) - 4*Izz3*l2^2*m2*ny*sin(q1) - 4*Izz2*l3^2*m3*ny*sin(q1) - 2*L2^2*l3^2*m3^2*nx*cos(q1) - 2*L2^2*l3^2*m3^2*ny*sin(q1) + L2*l3^2*lx2*m3^2*nx*sin(q1) + L2*l3^2*ly2*m3^2*ny*sin(q1) - L2*l3^2*lx2*m3^2*nx*sin(q1 + 2*q2 + 2*q3) - L2*l3^2*ly2*m3^2*ny*sin(q1 + 2*q2 + 2*q3) - 2*Izz3*L2*lx2*m3*ny*cos(q1) + 2*Izz3*L2*ly2*m3*nx*cos(q1) - 4*l2^2*l3^2*m2*m3*nx*cos(q1) + 2*Izz3*L2*lx2*m3*nx*sin(q1) + 2*Izz3*L2*ly2*m3*ny*sin(q1) - L2*l3^2*lx2*m3^2*ny*cos(q1 + 2*q2) + L2*l3^2*ly2*m3^2*nx*cos(q1 + 2*q2) + L2*l3^2*lx2*m3^2*ny*cos(q1 - 2*q3) - L2*l3^2*ly2*m3^2*nx*cos(q1 - 2*q3) - 4*l2^2*l3^2*m2*m3*ny*sin(q1) - 2*Izz3*l2*lx2*m2*ny*cos(q1) + 2*Izz3*l2*ly2*m2*nx*cos(q1) + L2*l3^2*lx2*m3^2*nx*sin(q1 + 2*q2) - L2*l3^2*lx2*m3^2*nx*sin(q1 - 2*q3) + L2*l3^2*ly2*m3^2*ny*sin(q1 + 2*q2) - L2*l3^2*ly2*m3^2*ny*sin(q1 - 2*q3) - 2*Izz3*L2*lx2*m3*ny*cos(q1 + 2*q2) + 2*Izz3*L2*ly2*m3*nx*cos(q1 + 2*q2) + 2*Izz3*l2*lx2*m2*nx*sin(q1) + 2*Izz3*l2*ly2*m2*ny*sin(q1) + 2*Izz3*L2*lx2*m3*nx*sin(q1 + 2*q2) + 2*Izz3*L2*ly2*m3*ny*sin(q1 + 2*q2) - 2*Izz3*l2*lx2*m2*ny*cos(q1 + 2*q2) + 2*Izz3*l2*ly2*m2*nx*cos(q1 + 2*q2) + 2*Izz3*l2*lx2*m2*nx*sin(q1 + 2*q2) + 2*Izz3*l2*ly2*m2*ny*sin(q1 + 2*q2) - L2*l3^2*lx2*m3^2*ny*cos(q1) + L2*l3^2*ly2*m3^2*nx*cos(q1) + L2*l3^2*lx2*m3^2*ny*cos(q1 + 2*q2 + 2*q3) - L2*l3^2*ly2*m3^2*nx*cos(q1 + 2*q2 + 2*q3) - 2*l2*l3^2*lx2*m2*m3*ny*cos(q1) + 2*l2*l3^2*ly2*m2*m3*nx*cos(q1) + 2*l2*l3^2*lx2*m2*m3*nx*sin(q1) + 2*l2*l3^2*ly2*m2*m3*ny*sin(q1) - 2*l2*l3^2*lx2*m2*m3*ny*cos(q1 + 2*q2) + 2*l2*l3^2*ly2*m2*m3*nx*cos(q1 + 2*q2) + 2*l2*l3^2*lx2*m2*m3*nx*sin(q1 + 2*q2) + 2*l2*l3^2*ly2*m2*m3*ny*sin(q1 + 2*q2)))/(2*(2*Izz1*Izz2*Izz3 + 2*Izz2*Izz3*L1^2*m2 + 2*Izz1*Izz3*L2^2*m3 + 2*Izz2*Izz3*L1^2*m3 + 2*Izz2*Izz3*l1^2*m1 + 2*Izz1*Izz3*l2^2*m2 + 2*Izz1*Izz2*l3^2*m3 + Izz3*L1^2*L2^2*m3^2 + Izz3*L1^2*l2^2*m2^2 + Izz1*L2^2*l3^2*m3^2 + Izz2*L1^2*l3^2*m3^2 - Izz3*L1^2*L2^2*m3^2*cos(2*q2) + 2*Izz3*l1^2*l2^2*m1*m2 + 2*Izz2*l1^2*l3^2*m1*m3 + 2*Izz1*l2^2*l3^2*m2*m3 - Izz3*L1^2*l2^2*m2^2*cos(2*q2) - Izz1*L2^2*l3^2*m3^2*cos(2*q3) - Izz2*L1^2*l3^2*m3^2*cos(2*q2 + 2*q3) + L1^2*L2^2*l3^2*m2*m3^2 + 2*Izz3*L1^2*L2^2*m2*m3 + L2^2*l1^2*l3^2*m1*m3^2 + L1^2*l2^2*l3^2*m2*m3^2 + L1^2*l2^2*l3^2*m2^2*m3 + 2*Izz3*L2^2*l1^2*m1*m3 + 2*Izz2*L1^2*l3^2*m2*m3 + 2*Izz3*L1^2*l2^2*m2*m3 + 2*l1^2*l2^2*l3^2*m1*m2*m3 - L1^2*l2^2*l3^2*m2^2*m3*cos(2*q2) - L2^2*l1^2*l3^2*m1*m3^2*cos(2*q3) - L1^2*l2^2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2 - 2*Izz3*L1^2*L2*l2*m2*m3 - L1^2*L2^2*l3^2*m2*m3^2*cos(2*q3) - 2*Izz3*L1^2*L2*l2*m2*m3*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q3))), (2*(nx*(ly2*cos(q1 + q2) + L1*cos(q1) + lx2*sin(q1 + q2)) + ny*(ly2*sin(q1 + q2) - lx2*cos(q1 + q2) + L1*sin(q1)))*(Izz2*Izz3 + (L2^2*l3^2*m3^2)/2 + Izz3*L2^2*m3 + Izz3*l2^2*m2 + Izz2*l3^2*m3 + l2^2*l3^2*m2*m3 - (L2^2*l3^2*m3^2*cos(2*q3))/2 + (L1*L2*l3^2*m3^2*cos(q2))/2 + Izz3*L1*L2*m3*cos(q2) - (L1*L2*l3^2*m3^2*cos(q2 + 2*q3))/2 + Izz3*L1*l2*m2*cos(q2) + L1*l2*l3^2*m2*m3*cos(q2)))/(2*Izz1*Izz2*Izz3 + 2*Izz2*Izz3*L1^2*m2 + 2*Izz1*Izz3*L2^2*m3 + 2*Izz2*Izz3*L1^2*m3 + 2*Izz2*Izz3*l1^2*m1 + 2*Izz1*Izz3*l2^2*m2 + 2*Izz1*Izz2*l3^2*m3 + Izz3*L1^2*L2^2*m3^2 + Izz3*L1^2*l2^2*m2^2 + Izz1*L2^2*l3^2*m3^2 + Izz2*L1^2*l3^2*m3^2 - Izz3*L1^2*L2^2*m3^2*cos(2*q2) + 2*Izz3*l1^2*l2^2*m1*m2 + 2*Izz2*l1^2*l3^2*m1*m3 + 2*Izz1*l2^2*l3^2*m2*m3 - Izz3*L1^2*l2^2*m2^2*cos(2*q2) - Izz1*L2^2*l3^2*m3^2*cos(2*q3) - Izz2*L1^2*l3^2*m3^2*cos(2*q2 + 2*q3) + L1^2*L2^2*l3^2*m2*m3^2 + 2*Izz3*L1^2*L2^2*m2*m3 + L2^2*l1^2*l3^2*m1*m3^2 + L1^2*l2^2*l3^2*m2*m3^2 + L1^2*l2^2*l3^2*m2^2*m3 + 2*Izz3*L2^2*l1^2*m1*m3 + 2*Izz2*L1^2*l3^2*m2*m3 + 2*Izz3*L1^2*l2^2*m2*m3 + 2*l1^2*l2^2*l3^2*m1*m2*m3 - L1^2*l2^2*l3^2*m2^2*m3*cos(2*q2) - L2^2*l1^2*l3^2*m1*m3^2*cos(2*q3) - L1^2*l2^2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2 - 2*Izz3*L1^2*L2*l2*m2*m3 - L1^2*L2^2*l3^2*m2*m3^2*cos(2*q3) - 2*Izz3*L1^2*L2*l2*m2*m3*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q3)) - (2*(ly2*nx*cos(q1 + q2) - lx2*ny*cos(q1 + q2) + lx2*nx*sin(q1 + q2) + ly2*ny*sin(q1 + q2))*(Izz1*Izz3 + Izz2*Izz3 + L1^2*l3^2*m3^2 + L2^2*l3^2*m3^2 + Izz3*L1^2*m2 + Izz3*L1^2*m3 + Izz3*L2^2*m3 + Izz3*l1^2*m1 + Izz1*l3^2*m3 + Izz3*l2^2*m2 + Izz2*l3^2*m3 - L1^2*l3^2*m3^2*cos(q2 + q3)^2 + L1^2*l3^2*m2*m3 + l1^2*l3^2*m1*m3 + l2^2*l3^2*m2*m3 - L2^2*l3^2*m3^2*cos(q3)^2 + 2*L1*L2*l3^2*m3^2*cos(q2) + 2*Izz3*L1*L2*m3*cos(q2) + 2*Izz3*L1*l2*m2*cos(q2) - 2*L1*L2*l3^2*m3^2*cos(q2 + q3)*cos(q3) + 2*L1*l2*l3^2*m2*m3*cos(q2)))/(2*Izz1*Izz2*Izz3 + 2*Izz2*Izz3*L1^2*m2 + 2*Izz1*Izz3*L2^2*m3 + 2*Izz2*Izz3*L1^2*m3 + 2*Izz2*Izz3*l1^2*m1 + 2*Izz1*Izz3*l2^2*m2 + 2*Izz1*Izz2*l3^2*m3 + Izz3*L1^2*L2^2*m3^2 + Izz3*L1^2*l2^2*m2^2 + Izz1*L2^2*l3^2*m3^2 + Izz2*L1^2*l3^2*m3^2 - Izz3*L1^2*L2^2*m3^2*cos(2*q2) + 2*Izz3*l1^2*l2^2*m1*m2 + 2*Izz2*l1^2*l3^2*m1*m3 + 2*Izz1*l2^2*l3^2*m2*m3 - Izz3*L1^2*l2^2*m2^2*cos(2*q2) - Izz1*L2^2*l3^2*m3^2*cos(2*q3) - Izz2*L1^2*l3^2*m3^2*cos(2*q2 + 2*q3) + L1^2*L2^2*l3^2*m2*m3^2 + 2*Izz3*L1^2*L2^2*m2*m3 + L2^2*l1^2*l3^2*m1*m3^2 + L1^2*l2^2*l3^2*m2*m3^2 + L1^2*l2^2*l3^2*m2^2*m3 + 2*Izz3*L2^2*l1^2*m1*m3 + 2*Izz2*L1^2*l3^2*m2*m3 + 2*Izz3*L1^2*l2^2*m2*m3 + 2*l1^2*l2^2*l3^2*m1*m2*m3 - L1^2*l2^2*l3^2*m2^2*m3*cos(2*q2) - L2^2*l1^2*l3^2*m1*m3^2*cos(2*q3) - L1^2*l2^2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2 - 2*Izz3*L1^2*L2*l2*m2*m3 - L1^2*L2^2*l3^2*m2*m3^2*cos(2*q3) - 2*Izz3*L1^2*L2*l2*m2*m3*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q3)), (2*(ly2*nx*cos(q1 + q2) - lx2*ny*cos(q1 + q2) + lx2*nx*sin(q1 + q2) + ly2*ny*sin(q1 + q2))*(Izz1*Izz3 + L1^2*l3^2*m3^2 + Izz3*L1^2*m2 + Izz3*L1^2*m3 + Izz3*l1^2*m1 + Izz1*l3^2*m3 - L1^2*l3^2*m3^2*cos(q2 + q3)^2 + L1^2*l3^2*m2*m3 + l1^2*l3^2*m1*m3 - L1*L2^2*l3*m3^2*cos(q2 + q3) + L1*L2*l3^2*m3^2*cos(q2) + L1^2*L2*l3*m3^2*cos(q3) - Izz2*L1*l3*m3*cos(q2 + q3) + Izz3*L1*L2*m3*cos(q2) + Izz3*L1*l2*m2*cos(q2) + Izz1*L2*l3*m3*cos(q3) - L1^2*L2*l3*m3^2*cos(q2 + q3)*cos(q2) - L1*L2*l3^2*m3^2*cos(q2 + q3)*cos(q3) + L1*L2^2*l3*m3^2*cos(q2)*cos(q3) - L1*l2^2*l3*m2*m3*cos(q2 + q3) + L1^2*L2*l3*m2*m3*cos(q3) + L1*l2*l3^2*m2*m3*cos(q2) + L2*l1^2*l3*m1*m3*cos(q3) - L1^2*l2*l3*m2*m3*cos(q2 + q3)*cos(q2) + L1*L2*l2*l3*m2*m3*cos(q2)*cos(q3)))/(2*Izz1*Izz2*Izz3 + 2*Izz2*Izz3*L1^2*m2 + 2*Izz1*Izz3*L2^2*m3 + 2*Izz2*Izz3*L1^2*m3 + 2*Izz2*Izz3*l1^2*m1 + 2*Izz1*Izz3*l2^2*m2 + 2*Izz1*Izz2*l3^2*m3 + Izz3*L1^2*L2^2*m3^2 + Izz3*L1^2*l2^2*m2^2 + Izz1*L2^2*l3^2*m3^2 + Izz2*L1^2*l3^2*m3^2 - Izz3*L1^2*L2^2*m3^2*cos(2*q2) + 2*Izz3*l1^2*l2^2*m1*m2 + 2*Izz2*l1^2*l3^2*m1*m3 + 2*Izz1*l2^2*l3^2*m2*m3 - Izz3*L1^2*l2^2*m2^2*cos(2*q2) - Izz1*L2^2*l3^2*m3^2*cos(2*q3) - Izz2*L1^2*l3^2*m3^2*cos(2*q2 + 2*q3) + L1^2*L2^2*l3^2*m2*m3^2 + 2*Izz3*L1^2*L2^2*m2*m3 + L2^2*l1^2*l3^2*m1*m3^2 + L1^2*l2^2*l3^2*m2*m3^2 + L1^2*l2^2*l3^2*m2^2*m3 + 2*Izz3*L2^2*l1^2*m1*m3 + 2*Izz2*L1^2*l3^2*m2*m3 + 2*Izz3*L1^2*l2^2*m2*m3 + 2*l1^2*l2^2*l3^2*m1*m2*m3 - L1^2*l2^2*l3^2*m2^2*m3*cos(2*q2) - L2^2*l1^2*l3^2*m1*m3^2*cos(2*q3) - L1^2*l2^2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2 - 2*Izz3*L1^2*L2*l2*m2*m3 - L1^2*L2^2*l3^2*m2*m3^2*cos(2*q3) - 2*Izz3*L1^2*L2*l2*m2*m3*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q3)) - (2*L1*(nx*(ly2*cos(q1 + q2) + L1*cos(q1) + lx2*sin(q1 + q2)) + ny*(ly2*sin(q1 + q2) - lx2*cos(q1 + q2) + L1*sin(q1)))*(L2*l3^2*m3^2*cos(q2) - Izz2*l3*m3*cos(q2 + q3) + Izz3*L2*m3*cos(q2) + Izz3*l2*m2*cos(q2) - L2^2*l3*m3^2*cos(q2 + q3) - l2^2*l3*m2*m3*cos(q2 + q3) + l2*l3^2*m2*m3*cos(q2) - L2*l3^2*m3^2*cos(q2 + q3)*cos(q3) + L2^2*l3*m3^2*cos(q2)*cos(q3) + L2*l2*l3*m2*m3*cos(q2)*cos(q3)))/(2*Izz1*Izz2*Izz3 + 2*Izz2*Izz3*L1^2*m2 + 2*Izz1*Izz3*L2^2*m3 + 2*Izz2*Izz3*L1^2*m3 + 2*Izz2*Izz3*l1^2*m1 + 2*Izz1*Izz3*l2^2*m2 + 2*Izz1*Izz2*l3^2*m3 + Izz3*L1^2*L2^2*m3^2 + Izz3*L1^2*l2^2*m2^2 + Izz1*L2^2*l3^2*m3^2 + Izz2*L1^2*l3^2*m3^2 - Izz3*L1^2*L2^2*m3^2*cos(2*q2) + 2*Izz3*l1^2*l2^2*m1*m2 + 2*Izz2*l1^2*l3^2*m1*m3 + 2*Izz1*l2^2*l3^2*m2*m3 - Izz3*L1^2*l2^2*m2^2*cos(2*q2) - Izz1*L2^2*l3^2*m3^2*cos(2*q3) - Izz2*L1^2*l3^2*m3^2*cos(2*q2 + 2*q3) + L1^2*L2^2*l3^2*m2*m3^2 + 2*Izz3*L1^2*L2^2*m2*m3 + L2^2*l1^2*l3^2*m1*m3^2 + L1^2*l2^2*l3^2*m2*m3^2 + L1^2*l2^2*l3^2*m2^2*m3 + 2*Izz3*L2^2*l1^2*m1*m3 + 2*Izz2*L1^2*l3^2*m2*m3 + 2*Izz3*L1^2*l2^2*m2*m3 + 2*l1^2*l2^2*l3^2*m1*m2*m3 - L1^2*l2^2*l3^2*m2^2*m3*cos(2*q2) - L2^2*l1^2*l3^2*m1*m3^2*cos(2*q3) - L1^2*l2^2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2 - 2*Izz3*L1^2*L2*l2*m2*m3 - L1^2*L2^2*l3^2*m2*m3^2*cos(2*q3) - 2*Izz3*L1^2*L2*l2*m2*m3*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2 + 2*q3) - L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q2) + L1^2*L2*l2*l3^2*m2*m3^2*cos(2*q3))]
